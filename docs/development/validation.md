---
layout: default
title: Valipop Validation
markdown: kramdown
---

# Valipop Validation

## Contigency Tables

Once the simulation has ended, if the [`output_tables`](../usage/configuration/config-reference.md#output_tables) config options is set to true, Valipop will generate contigency tables for targt population deaths, partnerships, separations, ordered births, and multiple births. A contigency table is a CSV file which contains records of an actual and expecetd entry for each type of the event that could occor for the property. The following shows a snippet of the deaths contigency table:

```csv
Source,YOB,Sex,Age,Died,Date,freq
SIM,1861,M,26,false,1887,6
STAT,1879,F,81,false,1960,1.814276533165328
STAT,1924,F,43,false,1967,16.05255878948318
SIM,1904,F,21,false,1925,10
```

`Source` refers to whether the frequency (`freq`) is the actual number (`SIM`) or exepcted number (`STAT`) for each event. An event here is represented as a unique tuple of `YOB` (year of birth), `Sex`, `Age`, `Died`, `Date`. For each tuple there should be at most an acutal and expected number. If the frequency is zero it is not included in the conteigency table.

The tuple of values varies for each type of contigency table, but they all contain a `Soruce` and `freq` field.

## Validation

The validation is completed by R using the contigency tables. The script which is execeuted is stored within the Valipop JAR file and written to the results directory to be executed when needed.

The R script reads in and cleans the data generated in the contigency table, and then passes it to the `geepack` function `geeglm`. `geeglm` calculates a Generalized Estimating Equations Genarlizer Linear Model to determine the signficance between the expected and actual event frequencies. The results of this analysis is written to an output file and read in by Valipop to interpret the results.

Valipop counts the number of 'stars' generated by the analysis, which only occur if the p value (which indicates the signficance of the results) is greater than a certain threshold. The more 'stars' counted, the more signficant the simulated population is from the input distributions. Ideally, we want 0 'stars' counted as that indicates that the simulated population and input distributions are statistically similar.
